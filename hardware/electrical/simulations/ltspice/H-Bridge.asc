Version 4
SHEET 1 1752 1204
WIRE 192 -304 -32 -304
WIRE 336 -304 192 -304
WIRE 784 -112 592 -112
WIRE 880 -112 784 -112
WIRE 928 -112 880 -112
WIRE 1040 -112 1040 -176
WIRE 1040 -112 992 -112
WIRE 784 -80 784 -112
WIRE 592 -64 592 -112
WIRE 880 -64 880 -112
WIRE 688 -16 656 -16
WIRE -720 32 -720 -32
WIRE -672 32 -720 32
WIRE -560 32 -608 32
WIRE -464 32 -560 32
WIRE -288 32 -464 32
WIRE 432 48 240 48
WIRE 592 48 592 32
WIRE 592 48 512 48
WIRE 688 48 688 -16
WIRE 784 48 784 0
WIRE 784 48 688 48
WIRE -464 64 -464 32
WIRE 592 64 592 48
WIRE -560 80 -560 32
WIRE -288 80 -288 32
WIRE 336 80 336 -304
WIRE -32 112 -32 -304
WIRE 688 112 688 48
WIRE 688 112 656 112
WIRE -352 128 -400 128
WIRE 240 160 240 48
WIRE 288 160 240 160
WIRE -464 192 -464 144
WIRE -400 192 -400 128
WIRE -400 192 -464 192
WIRE -288 192 -288 176
WIRE -224 192 -288 192
WIRE -80 192 -144 192
WIRE -288 208 -288 192
WIRE 592 208 592 160
WIRE 624 208 592 208
WIRE 880 208 880 0
WIRE 880 208 624 208
WIRE -400 256 -400 192
WIRE -352 256 -400 256
WIRE 784 256 784 48
WIRE 880 256 784 256
WIRE 992 304 944 304
WIRE 1152 304 1072 304
WIRE -560 352 -560 144
WIRE -288 352 -288 304
WIRE -288 352 -560 352
WIRE -32 352 -32 208
WIRE -32 352 -288 352
WIRE 32 352 -32 352
WIRE 176 352 112 352
WIRE 336 352 336 176
WIRE 336 352 256 352
WIRE 624 352 624 208
WIRE 624 352 336 352
WIRE -464 400 -464 192
WIRE -464 400 -560 400
WIRE 880 400 880 352
WIRE -752 448 -832 448
WIRE -624 448 -672 448
WIRE 880 496 880 480
WIRE -560 544 -560 496
WIRE -272 640 -272 608
WIRE -32 672 -32 352
WIRE -336 688 -368 688
WIRE 528 720 528 688
WIRE -512 752 -528 752
WIRE -368 752 -368 688
WIRE -368 752 -432 752
WIRE -272 752 -272 736
WIRE -256 752 -272 752
WIRE -224 752 -256 752
WIRE -112 752 -144 752
WIRE -80 752 -112 752
WIRE -272 768 -272 752
WIRE 336 768 336 352
WIRE 624 768 592 768
WIRE -256 800 -256 752
WIRE -224 800 -256 800
WIRE -368 816 -368 752
WIRE -336 816 -368 816
WIRE -112 832 -112 752
WIRE 624 832 624 768
WIRE 688 832 624 832
WIRE 848 832 768 832
WIRE 464 848 400 848
WIRE 528 848 528 816
WIRE 528 848 464 848
WIRE 528 864 528 848
WIRE -176 880 -224 880
WIRE -272 896 -272 864
WIRE 624 912 624 832
WIRE 624 912 592 912
WIRE 288 928 288 848
WIRE 384 928 288 928
WIRE 400 928 384 928
WIRE 464 976 464 848
WIRE 528 992 528 960
WIRE 384 1008 384 928
WIRE -224 1040 -224 880
WIRE -112 1040 -112 928
WIRE -112 1040 -144 1040
WIRE -32 1040 -32 768
WIRE -32 1040 -112 1040
WIRE 464 1056 448 1056
WIRE 464 1088 464 1056
WIRE -32 1184 -32 1040
WIRE 144 1184 -32 1184
WIRE 336 1184 336 864
WIRE 336 1184 144 1184
WIRE 384 1184 384 1104
WIRE 384 1184 336 1184
WIRE 464 1184 464 1168
WIRE 464 1184 384 1184
FLAG 1040 -176 12V
IOPIN 1040 -176 In
FLAG 528 992 0
FLAG 528 688 12V
IOPIN 528 688 In
FLAG -720 -32 12V
IOPIN -720 -32 In
FLAG -560 624 0
FLAG -272 608 12V
IOPIN -272 608 In
FLAG 144 1184 0
FLAG 192 -304 Vin
IOPIN 192 -304 In
FLAG -2304 816 0
FLAG -2224 816 0
FLAG -2144 816 0
FLAG -2064 816 0
FLAG -2304 736 Vin
IOPIN -2304 736 In
FLAG -2224 736 12V
IOPIN -2224 736 In
FLAG 880 496 0
FLAG -272 896 0
FLAG -528 752 Vb
IOPIN -528 752 In
FLAG 1152 304 Vb_L
IOPIN 1152 304 In
FLAG -832 448 Vf_L
IOPIN -832 448 In
FLAG -2064 736 Vf
IOPIN -2064 736 In
FLAG -2144 736 Vb
IOPIN -2144 736 In
FLAG -1984 736 Vf_L
IOPIN -1984 736 In
FLAG -1904 736 Vb_L
IOPIN -1904 736 In
FLAG -1984 816 0
FLAG -1904 816 0
FLAG 848 832 0
SYMBOL nmos 288 768 R0
WINDOW 3 -33 -6 Invisible 2
SYMATTR Value irlz44n
SYMATTR InstName M1
SYMATTR Prefix x
SYMBOL nmos -80 672 R0
WINDOW 3 56 72 Invisible 2
SYMATTR Value irlz44n
SYMATTR InstName M2
SYMATTR Prefix x
SYMBOL nmos 288 80 R0
WINDOW 3 56 72 Invisible 2
SYMATTR Value irlz44n
SYMATTR InstName M3
SYMATTR Prefix x
SYMBOL npn 656 -64 M0
SYMATTR InstName Q1
SYMATTR Value BC547C
SYMBOL pnp 656 160 R180
SYMATTR InstName Q2
SYMATTR Value BC557C
SYMBOL res 416 32 M90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R2
SYMATTR Value 10
SYMBOL res 800 -96 M0
SYMATTR InstName R3
SYMATTR Value 2k
SYMBOL cap 896 -64 M0
SYMATTR InstName C1
SYMATTR Value 100n
SYMBOL schottky 992 -96 M270
WINDOW 0 32 32 VTop 2
WINDOW 3 0 32 VBottom 2
SYMATTR InstName D1
SYMATTR Value MBR20100CT
SYMBOL npn 944 256 M0
SYMATTR InstName Q3
SYMATTR Value BC547C
SYMBOL res 896 384 M0
SYMATTR InstName R1
SYMATTR Value 100
SYMBOL res 976 288 M90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName 10
SYMATTR Value 1k
SYMBOL npn 592 720 M0
SYMATTR InstName Q4
SYMATTR Value BC547C
SYMBOL pnp 592 960 R180
SYMATTR InstName Q5
SYMATTR Value BC557C
SYMBOL res 672 816 M90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R5
SYMATTR Value 1k
SYMBOL nmos -80 112 R0
WINDOW 3 56 72 Invisible 2
SYMATTR Value irlz44n
SYMATTR InstName M5
SYMATTR Prefix x
SYMBOL npn -352 80 R0
SYMATTR InstName Q6
SYMATTR Value BC547C
SYMBOL pnp -352 304 M180
SYMATTR InstName Q7
SYMATTR Value BC557C
SYMBOL res -128 176 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R6
SYMATTR Value 10
SYMBOL res -480 48 R0
SYMATTR InstName R7
SYMATTR Value 2k
SYMBOL cap -576 80 R0
SYMATTR InstName C3
SYMATTR Value 100n
SYMBOL schottky -672 48 R270
WINDOW 0 32 32 VTop 2
WINDOW 3 0 32 VBottom 2
SYMATTR InstName D2
SYMATTR Value MBR20100CT
SYMBOL npn -624 400 R0
SYMATTR InstName Q8
SYMATTR Value BC547C
SYMBOL res -576 528 R0
SYMATTR InstName R8
SYMATTR Value 100
SYMBOL res -656 432 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R9
SYMATTR Value 2k
SYMBOL npn -336 640 R0
SYMATTR InstName Q9
SYMATTR Value BC547C
SYMBOL pnp -336 864 M180
SYMATTR InstName Q10
SYMATTR Value BC557C
SYMBOL res -416 736 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R10
SYMATTR Value 1k
SYMBOL voltage -2304 720 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V1
SYMATTR Value 24
SYMBOL voltage -2224 720 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V2
SYMATTR Value 12V
SYMBOL voltage -2144 720 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
WINDOW 3 24 96 Invisible 2
SYMATTR Value PULSE(0 3.3 {Vb_delay} 0.001u 0.001u {Vb_Ton} {Vperiod})
SYMATTR InstName V3
SYMBOL voltage -2064 720 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
WINDOW 3 24 96 Invisible 2
SYMATTR Value PULSE(0 12 {Vf_delay} 0.001u 0.001u {Vf_Ton} {Vperiod})
SYMATTR InstName V4
SYMBOL res -128 736 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R12
SYMATTR Value 10
SYMBOL res 128 336 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R11
SYMATTR Value 1.14
SYMBOL voltage -1984 720 R0
WINDOW 3 24 96 Invisible 2
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR Value PULSE(12 0 0 0.001u 0.001u {Vf_Ton_L} {Vperiod})
SYMATTR InstName V5
SYMBOL voltage -1904 720 R0
WINDOW 3 24 96 Invisible 2
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR Value PULSE(12 0 0 0.001u 0.001u {Vb_Ton_L} {Vperiod})
SYMATTR InstName V6
SYMBOL ind 160 368 R270
WINDOW 0 32 56 VTop 2
WINDOW 3 5 56 VBottom 2
SYMATTR InstName L1
SYMATTR Value 200µ
SYMBOL res 384 832 R0
SYMATTR InstName R4
SYMATTR Value 10
SYMBOL pnp 448 1104 R180
SYMATTR InstName Q11
SYMBOL res 448 960 R0
SYMATTR InstName R13
SYMATTR Value 5k
SYMBOL pnp -176 928 M180
SYMATTR InstName Q12
SYMBOL res -240 784 R0
SYMATTR InstName R14
SYMATTR Value 5k
SYMBOL res 448 1072 R0
SYMATTR InstName R15
SYMATTR Value 10k
SYMBOL res -128 1024 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R16
SYMATTR Value 10k
TEXT -688 -424 Left 2 !.include ./models/IRLZ44N.spi
TEXT -680 -384 Left 2 !.tran 5m
TEXT 696 -224 Left 2 ;High Side Driver
TEXT -496 -24 Left 2 ;High Side Driver
TEXT -960 408 Left 2 ;PWM input
TEXT 1208 336 Right 2 ;PWM input
TEXT 848 768 Right 2 ;PWM input
TEXT -632 816 Left 2 ;PWM input
TEXT 760 672 Right 2 ;Low Side Driver
TEXT -240 624 Left 2 ;Low Side Driver
TEXT 104 272 Left 2 ;Motor
TEXT -1664 736 Left 2 !.param Vf=0
TEXT -1664 768 Left 2 !.param Vb=1
TEXT -1672 672 Left 2 ;set Vf to 1 to move the motor "forwards"\nset Vb to 1 to move the motor "backwards"
TEXT -1672 856 Left 2 !.param Vperiod=25u
TEXT -1672 880 Left 2 !.param Vdutycycle=90
TEXT -1672 904 Left 2 !.param Ton={Vperiod*Vdutycycle/100}
TEXT -1672 952 Left 2 !.param Vf_Ton={Vf*Vperiod}
TEXT -1672 976 Left 2 !.param Vf_Ton_L={Vf*Ton}
TEXT -1672 1000 Left 2 !.param Vb_Ton={Vb*Vperiod + (1-Vb)*(Vperiod-Ton)}
TEXT -1672 1024 Left 2 !.param Vb_Ton_L={Vb*Ton}
TEXT -1672 1048 Left 2 !.param Vf_delay={Vf*(0)+(1-Vf)*Ton}
TEXT -1664 1072 Left 2 !.param Vb_delay={Vb*(0)+(1-Vb)*Ton}
